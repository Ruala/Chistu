"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};var _createClass=function(){function a(e,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||false;d.configurable=true;if("value" in d){d.writable=true}Object.defineProperty(e,d.key,d)}}return function(d,b,c){if(b){a(d.prototype,b)}if(c){a(d,c)}return d}}();var _get=function get(b,e,d){if(b===null){b=Function.prototype}var f=Object.getOwnPropertyDescriptor(b,e);if(f===undefined){var c=Object.getPrototypeOf(b);if(c===null){return undefined}else{return get(c,e,d)}}else{if("value" in f){return f.value}else{var a=f.get;if(a===undefined){return undefined}return a.call(d)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}var M={};var getTime=void 0;(function(){M.keys={TAB:9,ENTER:13,ESC:27,ARROW_UP:38,ARROW_DOWN:40};var a=Date.now||function(){return new Date().getTime()};M.throttle=function(c,e,i){var b=void 0,g=void 0,j=void 0;var h=null;var f=0;i||(i={});var d=function d(){f=i.leading===false?0:a();h=null;j=c.apply(b,g);b=g=null};return function(){var k=a();if(!f&&i.leading===false){f=k}var l=e-(k-f);b=this;g=arguments;if(l<=0){clearTimeout(h);h=null;f=k;j=c.apply(b,g);b=g=null}else{if(!h&&i.trailing!==false){h=setTimeout(d,l)}}return j}}})();(function(a){var c={duration:200,dist:-100,shift:0,padding:0,numVisible:5,fullWidth:false,indicators:false,noWrap:false,onCycleTo:null,getIndicators:null,getNavPrev:null,getNavNext:null};var b=function(){function x(E){var H=this;_classCallCheck(this,x);var F=E.el;if(!(F instanceof Element)){console.error(Error(F+" is not an HTML Element"))}this.el=F;this.$el=a(F);this.options=a.extend({},x.defaults,E);this.hasMultipleSlides=this.$el.find(".carousel-item").length>1;this.showIndicators=this.options.indicators&&this.hasMultipleSlides;this.noWrap=this.options.noWrap||!this.hasMultipleSlides;this.pressed=false;this.dragged=false;this.offset=this.target=0;this.images=[];this.itemWidth=this.$el.find(".carousel-item").first().innerWidth();this.itemHeight=this.$el.find(".carousel-item").first().innerHeight();this.dim=this.itemWidth*2+this.options.padding||1;this._autoScrollBound=this._autoScroll.bind(this);this._trackBound=this._track.bind(this);if(this.options.fullWidth){this.options.dist=0;this._setCarouselHeight();if(this.showIndicators){this.$el.find(".carousel-fixed-item").addClass("with-indicators")}}var G=false;if(this.$el.find(".indicators").length){this.$indicators=this.$el.find(".indicators")}else{if(typeof this.options.getIndicators==="function"){this.$indicators=this.options.getIndicators(this.$el)}else{this.$indicators=a('<ul class="indicators"></ul>');G=true}}this.$el.find(".carousel-item").each(function(I,J){H.images.push(J);if(H.showIndicators){var K=a('<li class="indicator-item"><a href="#"></a></li>');if(I===0){K[0].classList.add("active")}H.$indicators.append(K)}});if(this.showIndicators&&G){this.$el.append(this.$indicators)}this.count=this.images.length;this.$prev=this.$el.find(".carousel-prev");this.$next=this.$el.find(".carousel-next");if(typeof this.options.getNavPrev==="function"){this.$prev=this.$prev.add(this.options.getNavPrev(this.$el))}if(typeof this.options.getNavNext==="function"){this.$next=this.$next.add(this.options.getNavNext(this.$el))}this.options.numVisible=Math.min(this.count,this.options.numVisible);this.xform="transform";["webkit","Moz","O","ms"].every(function(I){var J=I+"Transform";if(typeof document.body.style[J]!=="undefined"){H.xform=J;return false}return true});this._setupEventHandlers();this._scroll(this.offset)}_createClass(x,[{key:"destroy",value:function C(){this._removeEventHandlers();this.el.M_Carousel=undefined}},{key:"_setupEventHandlers",value:function t(){var F=this;this._handleCarouselTapBound=this._handleCarouselTap.bind(this);this._handleCarouselDragBound=this._handleCarouselDrag.bind(this);this._handleCarouselReleaseBound=this._handleCarouselRelease.bind(this);this._handleCarouselClickBound=this._handleCarouselClick.bind(this);this._handleCarouselPrevBound=M.throttle(this._handleCarouselPrev,200).bind(this);this._handleCarouselNextBound=M.throttle(this._handleCarouselNext,200).bind(this);if(typeof window.ontouchstart!=="undefined"){this.el.addEventListener("touchstart",this._handleCarouselTapBound);this.el.addEventListener("touchmove",this._handleCarouselDragBound);this.el.addEventListener("touchend",this._handleCarouselReleaseBound)}this.el.addEventListener("mousedown",this._handleCarouselTapBound);this.el.addEventListener("mousemove",this._handleCarouselDragBound);this.el.addEventListener("mouseup",this._handleCarouselReleaseBound);this.el.addEventListener("mouseleave",this._handleCarouselReleaseBound);this.el.addEventListener("click",this._handleCarouselClickBound);this.$prev.on("click",this._handleCarouselPrevBound);this.$next.on("click",this._handleCarouselNextBound);if(this.showIndicators&&this.$indicators){this._handleIndicatorClickBound=this._handleIndicatorClick.bind(this);this.$indicators.find(".indicator-item").each(function(G,H){H.addEventListener("click",F._handleIndicatorClickBound)})}var E=M.throttle(this._handleResize,200);this._handleThrottledResizeBound=E.bind(this);window.addEventListener("resize",this._handleThrottledResizeBound)}},{key:"_removeEventHandlers",value:function z(){var E=this;if(typeof window.ontouchstart!=="undefined"){this.el.removeEventListener("touchstart",this._handleCarouselTapBound);this.el.removeEventListener("touchmove",this._handleCarouselDragBound);this.el.removeEventListener("touchend",this._handleCarouselReleaseBound)}this.el.removeEventListener("mousedown",this._handleCarouselTapBound);this.el.removeEventListener("mousemove",this._handleCarouselDragBound);this.el.removeEventListener("mouseup",this._handleCarouselReleaseBound);this.el.removeEventListener("mouseleave",this._handleCarouselReleaseBound);this.el.removeEventListener("click",this._handleCarouselClickBound);this.$prev.off("click",this._handleCarouselPrevBound);this.$next.off("click",this._handleCarouselNextBound);if(this.showIndicators&&this.$indicators){this.$indicators.find(".indicator-item").each(function(F,G){G.removeEventListener("click",E._handleIndicatorClickBound)})}window.removeEventListener("resize",this._handleThrottledResizeBound)}},{key:"_handleCarouselPrev",value:function e(E){E.preventDefault();E.stopPropagation();this.prev()}},{key:"_handleCarouselNext",value:function f(E){E.preventDefault();E.stopPropagation();this.next()}},{key:"_handleCarouselTap",value:function k(E){if(E.type==="mousedown"&&a(E.target).is("img")){E.preventDefault()}this.pressed=true;this.dragged=false;this.verticalDragged=false;this.reference=this._xpos(E);this.referenceY=this._ypos(E);this.velocity=this.amplitude=0;this.frame=this.offset;this.timestamp=Date.now();clearInterval(this.ticker);this.ticker=setInterval(this._trackBound,100)}},{key:"_handleCarouselDrag",value:function i(G){var F=void 0,I=void 0,H=void 0,E=void 0;if(this.pressed){F=this._xpos(G);I=this._ypos(G);H=this.reference-F;E=Math.abs(this.referenceY-I);if(E<30&&!this.verticalDragged){if(H>2||H<-2){this.dragged=true;this.reference=F;this._scroll(this.offset+H)}}else{if(this.dragged){G.preventDefault();G.stopPropagation();return false}else{this.verticalDragged=true}}}if(this.dragged){G.preventDefault();G.stopPropagation();return false}}},{key:"_handleCarouselRelease",value:function q(E){if(this.pressed){this.pressed=false}else{return}clearInterval(this.ticker);this.target=this.offset;if(this.velocity>10||this.velocity<-10){this.amplitude=0.9*this.velocity;this.target=this.offset+this.amplitude}this.target=Math.round(this.target/this.dim)*this.dim;if(this.noWrap){if(this.target>=this.dim*(this.count-1)){this.target=this.dim*(this.count-1)}else{if(this.target<0){this.target=0}}}this.amplitude=this.target-this.offset;this.timestamp=Date.now();requestAnimationFrame(this._autoScrollBound);if(this.dragged){E.preventDefault();E.stopPropagation()}return false}},{key:"_handleCarouselClick",value:function v(G){if(this.dragged){G.preventDefault();G.stopPropagation();return false}else{if(!this.options.fullWidth){var E=a(G.target).closest(".carousel-item").index();var F=this._wrap(this.center)-E;if(F!==0){G.preventDefault();G.stopPropagation()}this._cycleTo(E)}}}},{key:"_handleIndicatorClick",value:function m(F){F.stopPropagation();F.preventDefault();var E=a(F.target).closest(".indicator-item");if(E.length){this._cycleTo(E.index())}}},{key:"_handleResize",value:function j(E){if(this.options.fullWidth){this.itemWidth=this.$el.find(".carousel-item").first().innerWidth();this.imageHeight=this.$el.find(".carousel-item.active").height();this.dim=this.itemWidth*2+this.options.padding;this.offset=this.center*2*this.itemWidth;this.target=this.offset;this._setCarouselHeight(true)}else{this._scroll()}}},{key:"_setCarouselHeight",value:function h(J){var G=this;var N=this.$el.find(".carousel-item.active").length?this.$el.find(".carousel-item.active").first():this.$el.find(".carousel-item").first();var K=N.find("img").first();if(K.length){if(K[0].complete){var H=K.height();if(H>0){this.$el.css("height",H+"px")}else{var F=K[0].naturalWidth;var L=K[0].naturalHeight;var E=this.$el.width()/F*L;this.$el.css("height",E+"px")}}else{K.one("load",function(P,O){G.$el.css("height",P.offsetHeight+"px")})}}else{if(!J){var I=N.height();this.$el.css("height",I+"px")}}}},{key:"_xpos",value:function y(E){if(E.targetTouches&&E.targetTouches.length>=1){return E.targetTouches[0].clientX}return E.clientX}},{key:"_ypos",value:function D(E){if(E.targetTouches&&E.targetTouches.length>=1){return E.targetTouches[0].clientY}return E.clientY}},{key:"_wrap",value:function d(E){return E>=this.count?E%this.count:E<0?this._wrap(this.count+E%this.count):E}},{key:"_track",value:function g(){var G=void 0,E=void 0,H=void 0,F=void 0;G=Date.now();E=G-this.timestamp;this.timestamp=G;H=this.offset-this.frame;this.frame=this.offset;F=1000*H/(1+E);this.velocity=0.8*F+0.2*this.velocity}},{key:"_autoScroll",value:function p(){var E=void 0,F=void 0;if(this.amplitude){E=Date.now()-this.timestamp;F=this.amplitude*Math.exp(-E/this.options.duration);if(F>2||F<-2){this._scroll(this.target-F);requestAnimationFrame(this._autoScrollBound)}else{this._scroll(this.target)}}}},{key:"_scroll",value:function l(N){var U=this;if(!this.$el.hasClass("scrolling")){this.el.classList.add("scrolling")}if(this.scrollingTimeout!=null){window.clearTimeout(this.scrollingTimeout)}this.scrollingTimeout=window.setTimeout(function(){U.$el.removeClass("scrolling")},this.options.duration);var V=void 0,T=void 0,X=void 0,S=void 0,J=void 0,F=void 0,L=void 0,Z=void 0,Y=void 0,G=void 0;var H=this.center;var K=1/this.options.numVisible;this.offset=typeof N==="number"?N:this.offset;this.center=Math.floor((this.offset+this.dim/2)/this.dim);X=this.offset-this.center*this.dim;S=X<0?1:-1;J=-S*X*2/this.dim;T=this.count>>1;if(this.options.fullWidth){L="translateX(0)";G=1}else{L="translateX("+(this.el.clientWidth-this.itemWidth)/2+"px) ";L+="translateY("+(this.el.clientHeight-this.itemHeight)/2+"px)";G=1-K*J}if(this.showIndicators){var O=this.center%this.count;var W=this.$indicators.find(".indicator-item.active");if(W.index()!==O){W.removeClass("active");this.$indicators.find(".indicator-item").eq(O)[0].classList.add("active")}}if(!this.noWrap||this.center>=0&&this.center<this.count){F=this.images[this._wrap(this.center)];if(!a(F).hasClass("active")){this.$el.find(".carousel-item").removeClass("active");F.classList.add("active")}var Q=L+" translateX("+-X/2+"px) translateX("+S*this.options.shift*J*V+"px) translateZ("+this.options.dist*J+"px)";this._updateItemStyle(F,G,0,Q)}for(V=1;V<=T;++V){if(this.options.fullWidth){Z=this.options.dist;Y=V===T&&X<0?1-J:1}else{Z=this.options.dist*(V*2+J*S);Y=1-K*(V*2+J*S)}if(!this.noWrap||this.center+V<this.count){F=this.images[this._wrap(this.center+V)];var E=L+" translateX("+(this.options.shift+(this.dim*V-X)/2)+"px) translateZ("+Z+"px)";this._updateItemStyle(F,Y,-V,E)}if(this.options.fullWidth){Z=this.options.dist;Y=V===T&&X>0?1-J:1}else{Z=this.options.dist*(V*2-J*S);Y=1-K*(V*2-J*S)}if(!this.noWrap||this.center-V>=0){F=this.images[this._wrap(this.center-V)];var R=L+" translateX("+(-this.options.shift+(-this.dim*V-X)/2)+"px) translateZ("+Z+"px)";this._updateItemStyle(F,Y,-V,R)}}if(!this.noWrap||this.center>=0&&this.center<this.count){F=this.images[this._wrap(this.center)];var P=L+" translateX("+-X/2+"px) translateX("+S*this.options.shift*J+"px) translateZ("+this.options.dist*J+"px)";this._updateItemStyle(F,G,0,P)}var I=this.$el.find(".carousel-item").eq(this._wrap(this.center));if(H!==this.center&&typeof this.options.onCycleTo==="function"){this.options.onCycleTo.call(this,I[0],this.dragged)}if(typeof this.oneTimeCallback==="function"){this.oneTimeCallback.call(this,I[0],this.dragged);this.oneTimeCallback=null}}},{key:"_updateItemStyle",value:function n(G,F,H,E){G.style[this.xform]=E;G.style.zIndex=H;G.style.opacity=F;G.style.visibility="visible"}},{key:"_cycleTo",value:function u(G,F){var E=this.center%this.count-G;if(!this.noWrap){if(E<0){if(Math.abs(E+this.count)<Math.abs(E)){E+=this.count}}else{if(E>0){if(Math.abs(E-this.count)<E){E-=this.count}}}}this.target=this.dim*Math.round(this.offset/this.dim);if(E<0){this.target+=this.dim*Math.abs(E)}else{if(E>0){this.target-=this.dim*E}}if(typeof F==="function"){this.oneTimeCallback=F}if(this.offset!==this.target){this.amplitude=this.target-this.offset;this.timestamp=Date.now();requestAnimationFrame(this._autoScrollBound)}}},{key:"next",value:function s(F){if(F===undefined||isNaN(F)){F=1}var E=this.center+F;if(E>=this.count||E<0){if(this.noWrap){return}E=this._wrap(E)}this._cycleTo(E)}},{key:"prev",value:function r(F){if(F===undefined||isNaN(F)){F=1}var E=this.center-F;if(E>=this.count||E<0){if(this.noWrap){return}E=this._wrap(E)}this._cycleTo(E)}},{key:"set",value:function o(F,E){if(F===undefined||isNaN(F)){F=0}if(F>this.count||F<0){if(this.noWrap){return}F=this._wrap(F)}this._cycleTo(F,E)}}],[{key:"init",value:function w(F,E){return _get(x.__proto__||Object.getPrototypeOf(x),"init",this).call(this,this,F,E)}},{key:"getInstance",value:function A(F){var E=!!F.jquery?F[0]:F;return E.M_Carousel}},{key:"defaults",get:function B(){return c}}]);return x}();a.fn.carousel=function(){var g=this;var f=arguments[0]||{};var e=Array.prototype.slice.call(arguments,1);for(var h=0;h<g.length;h++){if((typeof f==="undefined"?"undefined":_typeof(f))==="object"){f.el=g[h];g[h].M_Carousel=new b(f)}else{var d=g[h].M_Carousel[f].call(g[h].M_Carousel,e);if(typeof d!=="undefined"){return d}}}return g}})(jQuery);